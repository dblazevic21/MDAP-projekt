---
title: "Predikcija odustajanja uƒçenika"
output:
  html_document:
    df_print: paged
---
```{r}
library(dplyr)

# Uƒçitavanje CSV datoteke
df <- read.csv("data.csv", sep = ";")

# Prilagodba naziva varijabli
names(df) <- make.names(names(df))

# Pogled prvih par redova
head(df)

# Struktura podataka
str(df)

```
```{r}
# Sa≈æetak skupa podataka:
# Kratak sa≈æetak svih varijabli
summary(df)

# Detaljan opis po tipu (kvantitativne, kvalitativne)
library(skimr)
skim(df)

```

Skup podataka sastoji se od 3820 opservacija i 37 varijabli, ukljuƒçujuƒái osobne, akademske i socijalno-ekonomske karakteristike studenata. Varijabla Target predstavlja ciljnu varijablu koja klasificira studente kao "Dropout", "Enrolled" ili "Graduate".
Podaci ukljuƒçuju numeriƒçke varijable (npr. Admission.grade, Age.at.enrollment, GDP) i kategorizirane cjelobrojne varijable koje predstavljaju ≈°ifre ili klasifikacije (npr. Gender, Course, Father's.qualification).


### Definiranje podskupa od 1500 opservacija sa stratificiranim omjerima po varijabli Target
```{r}
# Raspodjela klasa u originalnom skupu
table(df$Target)
prop.table(table(df$Target))  # relativne frekvencije

# Broj opservacija u podskupu
N <- 1500

# Stratificirano uzorkovanje
set.seed(123)  # reproducibilnost

library(dplyr)

df_sample <- df %>%
  group_by(Target) %>%
  sample_frac(size = N / nrow(df)) %>%
  ungroup()

# Provjera rezultata
table(df_sample$Target)
prop.table(table(df_sample$Target))
nrow(df_sample) # cca. 1500

```
| Klasifikacija | Originalno | Uzorak | Omjer u originalu | Omjer u uzorku |
| ------------- | ---------- | ------ | -------------- | ------------ |
| **Dropout**   | 1421       | 482    | 32.12%         | 32.13%       |
| **Enrolled**  | 794        | 269    | 17.95%         | 17.93%       |
| **Graduate**  | 2209       | 749    | 49.93%         | 49.93%       |
| **Ukupno**    | 4424       | 1500   | 100%           | 100%         |


Kako bismo smanjili dimenzionalnost skupa podataka i ubrzali analizu, konstruiran je stratificirani uzorak od 1500 opservacija.
Pri tome je zadr≈æana izvorna raspodjela ciljne varijable Target koja sadr≈æi tri klase: "Dropout", "Enrolled" i "Graduate".
Tako konstruirani uzorak reprezentativan je s obzirom na ishode studenata te je prikazan gornjom tablicom.

## Deskriptivna statistika

Iako su mnoge varijable bile zapisane kao cijeli brojevi (int), temeljem opisa podataka one predstavljaju kategorizirane informacije (npr. braƒçni status, spol, razina obrazovanja roditelja) te su stoga konvertirane u factor tip u R-u.
Time se omoguƒáuje ispravna analiza, vizualizacija i interpretacija. Varijable koje mjere koliƒçine (npr. ocjene, broj upisanih predmeta) zadr≈æane su kao kvantitativne varijable (numeric).

## Kvantitativne varijable
```{r}
kvantitativne <- c(
  "Previous.qualification..grade.",
  "Admission.grade",
  "Age.at.enrollment",
  "Curricular.units.1st.sem..grade.",
  "Curricular.units.2nd.sem..grade.",
  "Unemployment.rate",
  "Inflation.rate",
  "GDP",
  "Curricular.units.1st.sem..credited.",
  "Curricular.units.1st.sem..enrolled.",
  "Curricular.units.1st.sem..evaluations.",
  "Curricular.units.1st.sem..approved.",
  "Curricular.units.1st.sem..without.evaluations.",
  "Curricular.units.2nd.sem..credited.",
  "Curricular.units.2nd.sem..enrolled.",
  "Curricular.units.2nd.sem..evaluations.",
  "Curricular.units.2nd.sem..approved.",
  "Curricular.units.2nd.sem..without.evaluations."
)

```
```{r}
# Desktiptivna statistika kvant. varijabli:
df_kv <- df_sample[, kvantitativne]
library(dplyr)

deskriptiva_kv <- df_kv %>%
  summarise_all(list(
    Srednja = mean,
    Medijan = median,
    SD = sd,
    Q1 = ~quantile(., 0.25),
    Q3 = ~quantile(., 0.75),
    Min = min,
    Max = max
  ), na.rm = TRUE)

# Transponiranje za preglednost
deskriptiva_kv_t <- t(deskriptiva_kv)

# Prikaz tablice
knitr::kable(deskriptiva_kv_t, digits = 2,
             col.names = c("Srednja", "Medijan", "SD", "Q1", "Q3", "Min", "Max"),
             caption = "Deskriptivna statistika kvantitativnih varijabli")
```
```{r}
# Grafiƒçki prikaz histogrami:
library(ggplot2)

for (var in kvantitativne) {
  print(
    ggplot(df_sample, aes_string(x = var)) +
      geom_histogram(fill = "steelblue", color = "black", bins = 30) +
      labs(title = paste("Histogram varijable:", var), x = var, y = "Frekvencija") +
      theme_minimal()
  )
}

```
```{r}
# Grafiƒçki prikaz boxplotovi:
for (var in kvantitativne) {
  print(
    ggplot(df_sample, aes_string(y = var)) +
      geom_boxplot(fill = "darkorange", color = "black") +
      labs(title = paste("Boxplot varijable:", var), y = var) +
      theme_minimal()
  )
}

```

Na temelju 18 kvantitativnih varijabli iz podskupa, provedena je deskriptivna statistika i grafiƒçka analiza distribucije.
Izraƒçunate su mjere centralne tendencije i disperzije (srednja vrijednost, medijan, SD, kvartili), kao i ekstremne vrijednosti (min, max).
Histogrami prikazuju oblik distribucije podataka, dok boxploti dodatno vizualiziraju raspon i moguƒáa odstupanja (str≈°ila).


## Kvalitativne varijable
```{r}
kvalitativne <- c(
  "Marital.status", "Application.mode", "Application.order", "Course",
  "Daytime.evening.attendance.", "Previous.qualification", "Nacionality",
  "Mother.s.qualification", "Father.s.qualification", "Mother.s.occupation",
  "Father.s.occupation", "Displaced", "Educational.special.needs", "Debtor",
  "Tuition.fees.up.to.date", "Gender", "Scholarship.holder", "International",
  "Target"
)
# Pretvorba za lak≈°u analizu:
# Pretvori kvalitativne varijable u factor
df_sample[, kvalitativne] <- lapply(df_sample[, kvalitativne], as.factor)
# Provjera: sve bi trebale sada imati ispravan tip
str(df_sample)
```

```{r}
# Desktiptivna statistika kval. varijabli:
# Za svaku varijablu ispis moda i frekvencijske distribucije
for (var in kvalitativne) {
  cat("üîπ Varijabla:", var, "\n")
  mod_value <- names(sort(table(df_sample[[var]]), decreasing = TRUE))[1]
  cat("   Mod:", mod_value, "\n")
  print(sort(table(df_sample[[var]]), decreasing = TRUE))
  cat("\n")
}

```

```{r}
# Grafiƒçki prikaz ‚Äì stupƒçasti dijagram za svaku kvalitativnu varijablu:
library(ggplot2)

for (var in kvalitativne) {
  plot_data <- as.data.frame(table(df_sample[[var]]))
  colnames(plot_data) <- c("Kategorija", "Frekvencija")
  
  print(
    ggplot(plot_data, aes(x = reorder(Kategorija, -Frekvencija), y = Frekvencija)) +
      geom_bar(stat = "identity", fill = "darkgreen") +
      labs(title = paste("Barplot za varijablu:", var), x = var, y = "Frekvencija") +
      theme_minimal() +
      theme(axis.text.x = element_text(angle = 45, hjust = 1))
  )
}

```

Kvalitativne varijable analizirane su pomoƒáu frekvencijskih distribucija i moda / najƒçe≈°ƒáe vrijednosti.
Za svaku varijablu izraƒçunata je uƒçestalost pojavljivanja svih kategorija, a najfrekventnija vrijednost definirana je kao mod.
Vizualizacija je izvedena pomoƒáu stupƒçastih dijagrama, gdje se jasno uoƒçavaju dominantne kategorije.

## Odnos izmeƒëu numeriƒçkih varijabli

```{r}
install.packages("corrplot")
install.packages("GGally")
library(corrplot)
library(GGally)

```
### Korelacijska matrica numeriƒçkih varijabli:
```{r}
# Skraƒáeni nazivi (ruƒçno prilagoƒëeni za preglednost)
kratki_nazivi <- c(
  "Prev.Grade", "Adm.Grade", "Age.Enroll",
  "1st.Grade", "2nd.Grade", "Unemp.Rate", "Infl.Rate", "GDP",
  "1st.Cred", "1st.Enroll", "1st.Eval", "1st.Approv", "1st.NoEval",
  "2nd.Cred", "2nd.Enroll", "2nd.Eval", "2nd.Approv", "2nd.NoEval"
)

# Pripremi podatke i korelacijsku matricu
df_kv <- df_sample[, kvantitativne]
colnames(df_kv) <- kratki_nazivi

korelacija <- cor(df_kv, use = "complete.obs")

# Prika≈æi ƒçitku matricu
library(corrplot)
corrplot(korelacija, method = "color", type = "lower",
         tl.col = "black", tl.srt = 45,
         addCoef.col = "black", number.cex = 0.6, diag = FALSE)

```
### Dijagrami raspr≈°enja 
```{r}
# manji podskup radi preglednosti (npr. 6 varijabli)
colnames(df_kv) <- kratki_nazivi
GGally::ggpairs(df_kv[, 1:6])
#GGally::ggpairs(df_kv)


```
Zbog duljine naziva varijabli, kori≈°teni su skraƒáeni identifikatori u prikazu korelacijske matrice i dijagrama raspr≈°enja. Time se osigurava bolja preglednost i razumljivost rezultata bez gubitka znaƒçenja.

Korelacijska matrica pokazuje Pearsonove koeficijente linearne povezanosti izmeƒëu svih kvantitativnih varijabli.
Koeficijenti se kreƒáu izmeƒëu -1 i 1, gdje:

vrijednosti blizu +1 oznaƒçavaju jaku pozitivnu korelaciju,

vrijednosti blizu -1 oznaƒçavaju jaku negativnu korelaciju,

vrijednosti oko 0 ukazuju na slab ili nepostojeƒái linearni odnos.

Dijagrami raspr≈°enja dodatno ilustriraju linearnost i eventualne nelinearne obrasce meƒëu varijablama.